{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ofekg\\\\OneDrive\\\\\\u05E9\\u05D5\\u05DC\\u05D7\\u05DF \\u05D4\\u05E2\\u05D1\\u05D5\\u05D3\\u05D4\\\\Project-3\\\\frontend\\\\src\\\\components\\\\add-vacation\\\\add-vacation.tsx\";\nimport React from 'react';\nimport './add-vacation.css';\nimport { VacationModel } from '../../models/vacation-model';\nimport { Component } from 'react';\nimport { store } from \"../../redux/store\";\nimport { ActionType } from \"../../redux/action-type\";\nimport { PageNotFound } from '../page-not-found/page-not-found';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport DateFnsUtils from '@date-io/date-fns';\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers';\nexport class AddVacation extends Component {\n  constructor(props) {\n    super(props);\n    this.unsubscribeStore = void 0;\n\n    this.componentWillUnmount = () => {\n      this.unsubscribeStore();\n    };\n\n    this.componentDidMount = () => {\n      const vacation = { ...this.state.vacation\n      }; //for validation of date , same date return false when equale.\n\n      const date = new Date();\n      date.setHours(0, 0, 0);\n      vacation.fromDate = date;\n      vacation.toDate = date;\n      this.setState({\n        vacation\n      });\n    };\n\n    this.updateDestination = args => {\n      const input = args.target;\n      const destination = input.value;\n      const vacation = { ...this.state.vacation\n      };\n\n      if (destination.length < 3 || destination.length > 50) {\n        input.id = 'error';\n        vacation.destination = undefined;\n        this.setState({\n          vacation\n        });\n        return;\n      }\n\n      input.id = '';\n      vacation.destination = destination;\n      this.setState({\n        vacation\n      });\n    };\n\n    this.updateDescription = args => {\n      const input = args.target;\n      const description = input.value;\n      const vacation = { ...this.state.vacation\n      };\n\n      if (description.length < 4 || description.length > 300) {\n        input.id = 'error';\n        vacation.description = undefined;\n        this.setState({\n          vacation\n        });\n        return;\n      }\n\n      input.id = '';\n      vacation.description = description;\n      this.setState({\n        vacation\n      });\n    };\n\n    this.updateDepartingDate = (date, e) => {\n      const vacation = { ...this.state.vacation\n      };\n\n      if (date === null || date.toString() === 'Invalid Date') {\n        vacation.fromDate = null;\n        this.setState({\n          vacation\n        });\n        return;\n      }\n\n      vacation.fromDate = date;\n      this.setState({\n        vacation\n      });\n    };\n\n    this.updateReturningDate = (date, e) => {\n      const vacation = { ...this.state.vacation\n      };\n\n      if (date === null || date.toString() === 'Invalid Date') {\n        vacation.toDate = null;\n        this.setState({\n          vacation\n        });\n        return;\n      }\n\n      vacation.toDate = date;\n      this.setState({\n        vacation\n      });\n    };\n\n    this.updatePrice = args => {\n      const input = args.target;\n      const price = input.value;\n      const vacation = { ...this.state.vacation\n      };\n\n      if (price.length < 1 || price.length > 6 || isNaN(+price)) {\n        input.id = 'error';\n        vacation.price = undefined;\n        this.setState({\n          vacation\n        });\n        return;\n      }\n\n      input.id = '';\n      vacation.price = +price;\n      this.setState({\n        vacation\n      });\n    };\n\n    this.checkImage = event => {\n      const image = event.target.files[0];\n      const vacation = { ...this.state.vacation\n      };\n      vacation.image = image;\n      this.setState({\n        vacation\n      });\n    };\n\n    this.checkForm = async () => {\n      const vacation = { ...this.state.vacation\n      }; // validation\n\n      if (vacation.fromDate > vacation.toDate) {\n        alert('Returning date cannot be before departing !');\n        return;\n      }\n\n      if (vacation.fromDate === vacation.toDate) {\n        alert('Departing date cant be the same as returning date');\n        return;\n      }\n\n      if (!vacation.image) {\n        alert('You need to uplode image !');\n        return;\n      }\n\n      if (vacation.description === undefined || vacation.destination === undefined || vacation.fromDate === undefined || vacation.fromDate === null || vacation.toDate === undefined || vacation.toDate === null || vacation.price === undefined) {\n        alert('please fix all inputs / enter valid values .');\n        return;\n      }\n\n      this.sendForm();\n    };\n\n    this.sendForm = () => {\n      const vacation = { ...this.state.vacation\n      };\n      const formData = new FormData();\n      formData.append('image', vacation.image);\n      formData.append('vacation', JSON.stringify(vacation));\n      const options = {\n        method: \"POST\",\n        headers: {\n          \"Authorization\": \"Bearer \" + localStorage.getItem('token')\n        },\n        body: formData\n      };\n      fetch('http://localhost:3001/api/vacations/new-vacation', options).then(res => res.json()).then(vacation => {\n        const action = {\n          type: ActionType.addNewVacation,\n          payload: vacation\n        };\n        store.dispatch(action);\n        alert('vacation has been added !');\n        this.props.history.push(\"/admin-panel\");\n      }).catch(err => alert(err));\n    };\n\n    this.state = {\n      user: store.getState().user,\n      vacation: new VacationModel()\n    };\n    this.unsubscribeStore = store.subscribe(() => {\n      this.setState({\n        user: store.getState().user\n      });\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"addVacation\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, this.state.user.isAdmin ? React.createElement(\"form\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, React.createElement(\"table\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, \"destination :\")), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(TextField, {\n      variant: \"filled\",\n      onChange: this.updateDestination,\n      helperText: \"Type between 3-50 characters\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    })), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, \"description : \")), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, React.createElement(TextField, {\n      id: \"filled-textarea\",\n      multiline: true,\n      variant: \"filled\",\n      helperText: \"Type between 4-300 characters\",\n      onChange: this.updateDescription,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }))), React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, \"Departing : \")), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, React.createElement(MuiPickersUtilsProvider, {\n      utils: DateFnsUtils,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      container: true,\n      justify: \"space-around\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, React.createElement(KeyboardDatePicker, {\n      margin: \"normal\",\n      format: \"dd/MM/yyyy\",\n      value: this.state.vacation.fromDate,\n      onChange: this.updateDepartingDate,\n      KeyboardButtonProps: {\n        'aria-label': 'change date'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    })))), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, \"Returning : \")), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }, React.createElement(MuiPickersUtilsProvider, {\n      utils: DateFnsUtils,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      container: true,\n      justify: \"space-around\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }, React.createElement(KeyboardDatePicker, {\n      margin: \"normal\",\n      format: \"dd/MM/yyyy\",\n      value: this.state.vacation.toDate,\n      onChange: this.updateReturningDate,\n      KeyboardButtonProps: {\n        'aria-label': 'change date'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231\n      },\n      __self: this\n    }))))), React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }, \"Price : \")), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248\n      },\n      __self: this\n    }, React.createElement(TextField, {\n      label: \"price\",\n      variant: \"filled\",\n      helperText: \"Type between 1-6 characters\",\n      onChange: this.updatePrice,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249\n      },\n      __self: this\n    })), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }, \"Upload image\")), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      accept: \"image/*\",\n      className: \"imageUplode\",\n      id: \"outlined-button-file\",\n      multiple: true,\n      type: \"file\",\n      name: \"imageToUplode\",\n      onChange: this.checkImage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"outlined-button-file\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266\n      },\n      __self: this\n    }, React.createElement(Button, {\n      variant: \"outlined\",\n      component: \"span\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267\n      },\n      __self: this\n    }, \"Upload\")))))), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275\n      },\n      __self: this\n    }), React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      onClick: () => this.props.history.push(\"/admin-panel\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276\n      },\n      __self: this\n    }, \"Cancel\"), React.createElement(Button, {\n      variant: \"contained\",\n      color: \"secondary\",\n      onClick: this.checkForm,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    }, \"Add Vacation\")) : React.createElement(PageNotFound, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283\n      },\n      __self: this\n    }));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/ofekg/OneDrive/שולחן העבודה/Project-3/frontend/src/components/add-vacation/add-vacation.tsx"],"names":["React","VacationModel","Component","store","ActionType","PageNotFound","TextField","Button","Grid","DateFnsUtils","MuiPickersUtilsProvider","KeyboardDatePicker","AddVacation","constructor","props","unsubscribeStore","componentWillUnmount","componentDidMount","vacation","state","date","Date","setHours","fromDate","toDate","setState","updateDestination","args","input","target","destination","value","length","id","undefined","updateDescription","description","updateDepartingDate","e","toString","updateReturningDate","updatePrice","price","isNaN","checkImage","event","image","files","checkForm","alert","sendForm","formData","FormData","append","JSON","stringify","options","method","headers","localStorage","getItem","body","fetch","then","res","json","action","type","addNewVacation","payload","dispatch","history","push","catch","err","user","getState","subscribe","render","isAdmin"],"mappings":"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","sourcesContent":["import React, { SyntheticEvent } from 'react';\r\nimport './add-vacation.css';\r\nimport { VacationModel } from '../../models/vacation-model';\r\nimport { UserModel } from '../../models/user-model';\r\nimport { Component } from 'react';\r\nimport { store } from \"../../redux/store\";\r\nimport { Action } from \"../../redux/action\";\r\nimport { ActionType } from \"../../redux/action-type\";\r\nimport { Unsubscribe } from \"redux\";\r\nimport { PageNotFound } from '../page-not-found/page-not-found';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from '@material-ui/core/Button';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\nimport {\r\n    MuiPickersUtilsProvider,\r\n    KeyboardDatePicker,\r\n} from '@material-ui/pickers';\r\n\r\ninterface AddVacationState {\r\n    vacation: VacationModel;\r\n    user: UserModel;\r\n}\r\nexport class AddVacation extends Component<any, AddVacationState> {\r\n    private unsubscribeStore: Unsubscribe;\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n        this.state = {\r\n            user: store.getState().user,\r\n            vacation: new VacationModel()\r\n        }\r\n\r\n        this.unsubscribeStore = store.subscribe(() => {\r\n            this.setState({ user: store.getState().user });\r\n        });\r\n    }\r\n\r\n    public componentWillUnmount = () => {\r\n        this.unsubscribeStore();\r\n    }\r\n\r\n    public componentDidMount = () => {\r\n        const vacation = { ...this.state.vacation };\r\n        //for validation of date , same date return false when equale.\r\n        const date = new Date();\r\n        date.setHours(0, 0, 0);\r\n        vacation.fromDate = date;\r\n        vacation.toDate = date;\r\n        this.setState({ vacation });\r\n    }\r\n\r\n    private updateDestination = (args: SyntheticEvent) => {\r\n        const input = (args.target as HTMLSelectElement);\r\n        const destination = input.value;\r\n        const vacation = { ...this.state.vacation };\r\n        if (destination.length < 3 || destination.length > 50) {\r\n            input.id = 'error';\r\n            vacation.destination = undefined;\r\n            this.setState({ vacation });\r\n            return;\r\n        }\r\n        input.id = '';\r\n        vacation.destination = destination;\r\n        this.setState({ vacation });\r\n    }\r\n    private updateDescription = (args: SyntheticEvent) => {\r\n        const input = (args.target as HTMLSelectElement);\r\n        const description = input.value;\r\n        const vacation = { ...this.state.vacation };\r\n        if (description.length < 4 || description.length > 300) {\r\n            input.id = 'error';\r\n            vacation.description = undefined;\r\n            this.setState({ vacation });\r\n            return;\r\n        }\r\n        input.id = '';\r\n        vacation.description = description;\r\n        this.setState({ vacation });\r\n    }\r\n    private updateDepartingDate = (date: Date, e: any) => {\r\n        const vacation = { ...this.state.vacation };\r\n        if (date === null || date.toString() === 'Invalid Date') {\r\n            vacation.fromDate = null;\r\n            this.setState({ vacation });\r\n            return;\r\n        }\r\n        vacation.fromDate = date;\r\n        this.setState({ vacation });\r\n    }\r\n    private updateReturningDate = (date: Date, e: any) => {\r\n        const vacation = { ...this.state.vacation };\r\n        if (date === null || date.toString() === 'Invalid Date') {\r\n            vacation.toDate = null;\r\n            this.setState({ vacation });\r\n            return;\r\n        }\r\n        vacation.toDate = date;\r\n        this.setState({ vacation });\r\n    }\r\n    private updatePrice = (args: SyntheticEvent) => {\r\n        const input = (args.target as HTMLSelectElement);\r\n        const price = input.value;\r\n        const vacation = { ...this.state.vacation };\r\n        if (price.length < 1 || price.length > 6 || isNaN(+price)) {\r\n            input.id = 'error';\r\n            vacation.price = undefined;\r\n            this.setState({ vacation });\r\n            return;\r\n        }\r\n        input.id = '';\r\n        vacation.price = +price;\r\n        this.setState({ vacation });\r\n    }\r\n    private checkImage = (event: any) => {\r\n        const image = event.target.files[0];\r\n        const vacation = { ...this.state.vacation };\r\n        vacation.image = image;\r\n        this.setState({ vacation });\r\n    }\r\n\r\n    private checkForm = async () => {\r\n        const vacation = { ...this.state.vacation };\r\n        // validation\r\n        if (vacation.fromDate > vacation.toDate) {\r\n            alert('Returning date cannot be before departing !');\r\n            return;\r\n        }\r\n        if (vacation.fromDate === vacation.toDate) {\r\n            alert('Departing date cant be the same as returning date');\r\n            return;\r\n        }\r\n        if (!vacation.image) {\r\n            alert('You need to uplode image !');\r\n            return;\r\n        }\r\n        if (vacation.description === undefined || vacation.destination === undefined ||\r\n            vacation.fromDate === undefined || vacation.fromDate === null ||\r\n            vacation.toDate === undefined || vacation.toDate === null || vacation.price === undefined) {\r\n            alert('please fix all inputs / enter valid values .');\r\n            return;\r\n        }\r\n        this.sendForm();\r\n    }\r\n\r\n    private sendForm = () => {\r\n        const vacation = { ...this.state.vacation }\r\n        const formData = new FormData();\r\n        formData.append('image', vacation.image);\r\n        formData.append('vacation' , JSON.stringify(vacation))\r\n\r\n        const options = {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Authorization\": \"Bearer \" + localStorage.getItem('token')\r\n            },\r\n            body: formData\r\n        };\r\n\r\n        fetch('http://localhost:3001/api/vacations/new-vacation', options)\r\n            .then(res => res.json())\r\n            .then(vacation => {\r\n                const action: Action = {\r\n                    type: ActionType.addNewVacation,\r\n                    payload: vacation\r\n                };\r\n                store.dispatch(action);\r\n\r\n                alert('vacation has been added !');\r\n                this.props.history.push(\"/admin-panel\");\r\n            })\r\n            .catch(err => alert(err));\r\n    }\r\n    \r\n    public render(): JSX.Element {\r\n        return (\r\n            <div className='addVacation'>\r\n                {this.state.user.isAdmin ?\r\n                    <form>\r\n\r\n                        <table>\r\n                            <tbody>\r\n                                <tr>\r\n                                    <td>\r\n                                        <p>destination :</p>\r\n                                    </td>\r\n                                    <td>\r\n                                        <TextField variant=\"filled\"\r\n                                            onChange={this.updateDestination}\r\n                                            helperText=\"Type between 3-50 characters\"\r\n                                        />\r\n                                    </td>\r\n                                    <td>\r\n                                        <p>description : </p>\r\n                                    </td>\r\n                                    <td>\r\n                                        <TextField\r\n                                            id=\"filled-textarea\"\r\n                                            multiline\r\n                                            variant=\"filled\"\r\n                                            helperText=\"Type between 4-300 characters\"\r\n                                            onChange={this.updateDescription}\r\n                                        />\r\n                                    </td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>\r\n                                        <p>Departing : </p>\r\n                                    </td>\r\n                                    <td>\r\n                                        <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n                                            <Grid container justify=\"space-around\">\r\n                                                <KeyboardDatePicker\r\n                                                    margin=\"normal\"\r\n                                                    format=\"dd/MM/yyyy\"\r\n                                                    value={this.state.vacation.fromDate}\r\n                                                    onChange={this.updateDepartingDate}\r\n                                                    KeyboardButtonProps={{\r\n                                                        'aria-label': 'change date',\r\n                                                    }}\r\n                                                />\r\n                                            </Grid>\r\n                                        </MuiPickersUtilsProvider>\r\n                                    </td>\r\n                                    <td>\r\n                                        <p>Returning : </p>\r\n                                    </td>\r\n                                    <td>\r\n                                        <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n                                            <Grid container justify=\"space-around\">\r\n                                                <KeyboardDatePicker\r\n                                                    margin=\"normal\"\r\n                                                    format=\"dd/MM/yyyy\"\r\n                                                    value={this.state.vacation.toDate}\r\n                                                    onChange={this.updateReturningDate}\r\n                                                    KeyboardButtonProps={{\r\n                                                        'aria-label': 'change date',\r\n                                                    }}\r\n                                                />\r\n                                            </Grid>\r\n                                        </MuiPickersUtilsProvider>\r\n                                    </td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>\r\n                                        <p>Price : </p>\r\n                                    </td>\r\n                                    <td>\r\n                                        <TextField label=\"price\" variant=\"filled\"\r\n                                            helperText=\"Type between 1-6 characters\"\r\n                                            onChange={this.updatePrice} />\r\n                                    </td>\r\n                                    <td>\r\n                                        <p>Upload image</p>\r\n                                    </td>\r\n                                    <td>\r\n                                        <input\r\n                                            accept=\"image/*\"\r\n                                            className=\"imageUplode\"\r\n                                            id=\"outlined-button-file\"\r\n                                            multiple\r\n                                            type=\"file\"\r\n                                            name=\"imageToUplode\"\r\n                                            onChange={this.checkImage}\r\n                                        />\r\n                                        <label htmlFor=\"outlined-button-file\">\r\n                                            <Button variant=\"outlined\" component=\"span\">\r\n                                                Upload\r\n                                             </Button>\r\n                                        </label>\r\n                                    </td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                        <hr />\r\n                        <Button variant=\"contained\" color=\"primary\" onClick={() => this.props.history.push(\"/admin-panel\")}>\r\n                            Cancel\r\n                        </Button>\r\n                        <Button variant=\"contained\" color=\"secondary\" onClick={this.checkForm}>\r\n                            Add Vacation\r\n                      </Button>\r\n                    </form>\r\n                    : <PageNotFound />}\r\n            </div >\r\n        );\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}