{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ofekg\\\\OneDrive\\\\\\u05E9\\u05D5\\u05DC\\u05D7\\u05DF \\u05D4\\u05E2\\u05D1\\u05D5\\u05D3\\u05D4\\\\Project-3\\\\frontend\\\\src\\\\components\\\\admin-panel\\\\admin-panel.tsx\";\nimport React, { Component } from 'react';\nimport './admin-panel.css';\nimport { store } from \"../../redux/store\";\nimport { ActionType } from \"../../redux/action-type\";\nimport { PageNotFound } from '../page-not-found/page-not-found';\nimport EditIcon from '@material-ui/icons/Edit';\nimport RemoveIcon from '@material-ui/icons/RemoveCircleOutline';\nimport AddIcon from '@material-ui/icons/AddCircleOutline';\nimport Button from '@material-ui/core/Button';\nimport EqualizerIcon from '@material-ui/icons/Equalizer';\nimport { NavLink } from 'react-router-dom';\nexport class AdminPanel extends Component {\n  constructor(props) {\n    super(props);\n    this.unsubscribeStore = void 0;\n\n    this.componentDidMount = () => {\n      if (store.getState().vacations.length < 1) {\n        fetch('http://localhost:3001/api/vacations').then(res => res.json()).then(vacations => {\n          const action = {\n            type: ActionType.getAllVacations,\n            payload: vacations\n          };\n          store.dispatch(action);\n        }).catch(err => alert(err));\n      }\n    };\n\n    this.componentWillUnmount = () => {\n      this.unsubscribeStore();\n    };\n\n    this.deleteVacation = vacation => {\n      const answer = window.confirm(\"Are you sure?\");\n\n      if (!answer) {\n        return;\n      }\n\n      const options = {\n        method: \"DELETE\",\n        headers: {\n          \"Authorization\": \"Bearer \" + localStorage.getItem('token'),\n          \"Content-Type\": \"application/json\",\n          \"Accept\": \"application/json\"\n        },\n        body: JSON.stringify(vacation)\n      };\n      fetch(`http://localhost:3001/api/vacations/delete-vacation`, options).then(() => {\n        alert(\"Vacation has been successfully deleted.\");\n        const action = {\n          type: ActionType.deleteVacation,\n          payload: vacation.vacationID\n        };\n        store.dispatch(action);\n      }).catch(err => alert(err.message));\n    };\n\n    this.state = {\n      user: store.getState().user,\n      vacations: store.getState().vacations\n    };\n    this.unsubscribeStore = store.subscribe(() => {\n      this.setState({\n        user: store.getState().user\n      });\n      this.setState({\n        vacations: store.getState().vacations\n      });\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"adminPanel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, !this.state.user.isAdmin ? React.createElement(PageNotFound, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(AddIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }), React.createElement(NavLink, {\n      to: \"/add-vacation\",\n      exact: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, \"Add Vacation\")), React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, React.createElement(EqualizerIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }), React.createElement(NavLink, {\n      to: \"/chart\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, \"Reports\")), React.createElement(\"table\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, \"ID\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, \"destination\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"Price\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, \"Edit\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, \"Delete\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, this.state.vacations.map(v => React.createElement(\"tr\", {\n      key: v.vacationID,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, v.vacationID), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, v.destination), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, v.price, \" $\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(NavLink, {\n      to: `/edit-vacation/${v.vacationID}`,\n      exact: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(EditIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }))), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(RemoveIcon, {\n      onClick: () => this.deleteVacation(v),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }))))))));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/ofekg/OneDrive/שולחן העבודה/Project-3/frontend/src/components/admin-panel/admin-panel.tsx"],"names":["React","Component","store","ActionType","PageNotFound","EditIcon","RemoveIcon","AddIcon","Button","EqualizerIcon","NavLink","AdminPanel","constructor","props","unsubscribeStore","componentDidMount","getState","vacations","length","fetch","then","res","json","action","type","getAllVacations","payload","dispatch","catch","err","alert","componentWillUnmount","deleteVacation","vacation","answer","window","confirm","options","method","headers","localStorage","getItem","body","JSON","stringify","vacationID","message","state","user","subscribe","setState","render","isAdmin","map","v","destination","price"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport './admin-panel.css';\r\nimport { UserModel } from '../../models/user-model';\r\nimport { VacationModel } from '../../models/vacation-model';\r\nimport { store } from \"../../redux/store\";\r\nimport { Action } from \"../../redux/action\";\r\nimport { ActionType } from \"../../redux/action-type\";\r\nimport { Unsubscribe } from \"redux\";\r\nimport { PageNotFound } from '../page-not-found/page-not-found';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport RemoveIcon from '@material-ui/icons/RemoveCircleOutline';\r\nimport AddIcon from '@material-ui/icons/AddCircleOutline';\r\nimport Button from '@material-ui/core/Button';\r\nimport EqualizerIcon from '@material-ui/icons/Equalizer';\r\nimport { NavLink } from 'react-router-dom';\r\n\r\ninterface AdminPanelState {\r\n    user: UserModel;\r\n    vacations: VacationModel[];\r\n}\r\n\r\nexport class AdminPanel extends Component<any, AdminPanelState> {\r\n    private unsubscribeStore: Unsubscribe;\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n        this.state = {\r\n            user: store.getState().user,\r\n            vacations: store.getState().vacations\r\n        }\r\n\r\n        this.unsubscribeStore = store.subscribe(() => {\r\n            this.setState({ user: store.getState().user });\r\n            this.setState({ vacations: store.getState().vacations });\r\n        });\r\n    }\r\n    public componentDidMount = () => {\r\n        if (store.getState().vacations.length < 1) {\r\n            fetch('http://localhost:3001/api/vacations')\r\n                .then(res => res.json())\r\n                .then(vacations => {\r\n                    const action: Action = {\r\n                        type: ActionType.getAllVacations,\r\n                        payload: vacations\r\n                    };\r\n                    store.dispatch(action);\r\n                })\r\n                .catch(err => alert(err));\r\n            }\r\n        }\r\n\r\n    public componentWillUnmount = () => {\r\n        this.unsubscribeStore();\r\n    }\r\n    private deleteVacation = (vacation: VacationModel) => {\r\n        const answer = window.confirm(\"Are you sure?\");\r\n        if (!answer) {\r\n            return;\r\n        }\r\n\r\n        const options = {\r\n            method: \"DELETE\",\r\n            headers: {\r\n                \"Authorization\": \"Bearer \" + localStorage.getItem('token'),\r\n                \"Content-Type\": \"application/json\",\r\n                \"Accept\": \"application/json\"\r\n            },\r\n            body: JSON.stringify(vacation)\r\n        };\r\n\r\n        fetch(`http://localhost:3001/api/vacations/delete-vacation`, options)\r\n            .then(() => {\r\n                alert(\"Vacation has been successfully deleted.\");\r\n                const action: Action = {\r\n                    type: ActionType.deleteVacation,\r\n                    payload: vacation.vacationID\r\n                };\r\n                store.dispatch(action);\r\n            })\r\n            .catch(err => alert(err.message));\r\n    }\r\n\r\n    public render(): JSX.Element {\r\n        return (\r\n            <div className='adminPanel'>\r\n                {!this.state.user.isAdmin ? <PageNotFound /> :\r\n                  <div>\r\n                        <Button variant=\"contained\" color=\"primary\">\r\n                            <AddIcon />\r\n                            <NavLink to='/add-vacation' exact>Add Vacation</NavLink>\r\n                        </Button>\r\n                        <Button variant=\"contained\" color=\"primary\">\r\n                            <EqualizerIcon />\r\n                            <NavLink to='/chart'>Reports</NavLink>\r\n                        </Button>\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>ID</th>\r\n                                    <th>destination</th>\r\n                                    <th>Price</th>\r\n                                    <th>Edit</th>\r\n                                    <th>Delete</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {this.state.vacations.map(v =>\r\n                                    <tr key={v.vacationID}>\r\n                                        <td>{v.vacationID}</td>\r\n                                        <td>{v.destination}</td>\r\n                                        <td>{v.price} $</td>\r\n                                        <td>\r\n                                            <NavLink to={`/edit-vacation/${v.vacationID}`} exact>\r\n                                                <EditIcon />\r\n                                            </NavLink>\r\n                                        </td>\r\n                                        <td>\r\n                                            <RemoveIcon onClick={() => this.deleteVacation(v)} />\r\n                                        </td>\r\n                                    </tr>)}\r\n                            </tbody>\r\n                        </table>\r\n                        </div>\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}