{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ofekg\\\\OneDrive\\\\\\u05E9\\u05D5\\u05DC\\u05D7\\u05DF \\u05D4\\u05E2\\u05D1\\u05D5\\u05D3\\u05D4\\\\Project-3\\\\frontend\\\\src\\\\components\\\\chart\\\\chart.tsx\";\nimport React, { Component } from 'react';\nimport './chart.css';\nimport { VictoryBar, VictoryChart, VictoryAxis, VictoryTheme } from 'victory';\nimport { store } from \"../../redux/store\";\nimport { PageNotFound } from '../page-not-found/page-not-found';\nexport class Chart extends Component {\n  constructor(props) {\n    super(props);\n    this.unsubscribeStore = void 0;\n\n    this.componentWillUnmount = () => {\n      this.unsubscribeStore();\n    };\n\n    this.componentDidMount = () => {\n      const options = {\n        method: \"GET\",\n        headers: {\n          \"Authorization\": \"Bearer \" + localStorage.getItem('token')\n        }\n      };\n      fetch('http://localhost:3001/api/vacations/followed/get-all', options).then(res => res.json()).then(vacations => this.arrangeVacations(vacations)).catch(err => alert(err));\n      setTimeout(() => {\n        this.arrangeTicksValueForChart();\n        this.arrangeTicksFormatForChart();\n      }, 1000);\n    };\n\n    this.arrangeVacations = vacations => {\n      const stateVacations = [...this.state.vacations];\n      vacations.forEach(v => {\n        let obj = {\n          vacationID: +v.vacationID,\n          followers: 1\n        };\n        const vacation = stateVacations.find(f => f.vacationID === v.vacationID);\n\n        if (vacation) {\n          vacation.followers += 1;\n          return;\n        }\n\n        stateVacations.push(obj);\n      });\n      stateVacations.sort((a, b) => {\n        return a.vacationID - b.vacationID;\n      });\n      this.setState({\n        vacations: stateVacations\n      });\n    };\n\n    this.arrangeTicksValueForChart = () => {\n      const vacations = [...this.state.vacations];\n      const tickValueArr = [...this.state.tickValueArr];\n      vacations.map(v => tickValueArr.push(v.vacationID));\n      this.setState({\n        tickValueArr\n      });\n    };\n\n    this.arrangeTicksFormatForChart = () => {\n      const vacations = [...this.state.vacations];\n      const tickFormatArr = [...this.state.tickFormatArr];\n      vacations.map(v => tickFormatArr.push(`ID : ${v.vacationID}`));\n      this.setState({\n        tickFormatArr\n      });\n    };\n\n    this.state = {\n      user: store.getState().user,\n      vacations: [],\n      tickValueArr: [],\n      tickFormatArr: []\n    };\n    this.unsubscribeStore = store.subscribe(() => {\n      this.setState({\n        user: store.getState().user\n      });\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"chart\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, this.state.user.isAdmin ? React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, \"Reports Page\"), React.createElement(VictoryChart, {\n      theme: VictoryTheme.material,\n      width: 600,\n      domainPadding: 60,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(VictoryAxis, {\n      tickValues: this.state.tickValueArr,\n      tickFormat: this.state.tickFormatArr,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }), React.createElement(VictoryAxis, {\n      dependentAxis: true,\n      tickFormat: x => `${x}`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }), React.createElement(VictoryBar, {\n      data: this.state.vacations,\n      x: \"vacationID\",\n      y: \"followers\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }))) : React.createElement(PageNotFound, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/ofekg/OneDrive/שולחן העבודה/Project-3/frontend/src/components/chart/chart.tsx"],"names":["React","Component","VictoryBar","VictoryChart","VictoryAxis","VictoryTheme","store","PageNotFound","Chart","constructor","props","unsubscribeStore","componentWillUnmount","componentDidMount","options","method","headers","localStorage","getItem","fetch","then","res","json","vacations","arrangeVacations","catch","err","alert","setTimeout","arrangeTicksValueForChart","arrangeTicksFormatForChart","stateVacations","state","forEach","v","obj","vacationID","followers","vacation","find","f","push","sort","a","b","setState","tickValueArr","map","tickFormatArr","user","getState","subscribe","render","isAdmin","material","x"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport './chart.css';\r\nimport { VictoryBar, VictoryChart, VictoryAxis, VictoryTheme } from 'victory';\r\nimport { UserModel } from '../../models/user-model';\r\nimport { store } from \"../../redux/store\";\r\nimport { Unsubscribe } from \"redux\";\r\nimport { PageNotFound } from '../page-not-found/page-not-found';\r\n\r\ninterface ChartState {\r\n  vacations: any[];\r\n  tickValueArr: any[];\r\n  tickFormatArr: any[];\r\n  user: UserModel;\r\n}\r\n\r\nexport class Chart extends Component<any, ChartState> {\r\n  private unsubscribeStore: Unsubscribe;\r\n\r\n  public constructor(props: any) {\r\n    super(props);\r\n    this.state = {\r\n      user: store.getState().user,\r\n      vacations: [],\r\n      tickValueArr: [],\r\n      tickFormatArr: []\r\n    }\r\n    this.unsubscribeStore = store.subscribe(() => {\r\n      this.setState({ user: store.getState().user });\r\n    });\r\n  }\r\n\r\n  public componentWillUnmount = () => {\r\n    this.unsubscribeStore();\r\n  }\r\n  public componentDidMount = () => {\r\n    const options = {\r\n      method: \"GET\",\r\n      headers: {\r\n        \"Authorization\": \"Bearer \" + localStorage.getItem('token')\r\n      }\r\n    };\r\n\r\n    fetch('http://localhost:3001/api/vacations/followed/get-all', options)\r\n      .then(res => res.json())\r\n      .then(vacations => this.arrangeVacations(vacations))\r\n      .catch(err => alert(err));\r\n\r\n    setTimeout(() => {\r\n      this.arrangeTicksValueForChart();\r\n      this.arrangeTicksFormatForChart();\r\n    }, 1000)\r\n  }\r\n\r\n  private arrangeVacations = (vacations: any) => {\r\n    const stateVacations = [...this.state.vacations];\r\n    vacations.forEach((v: any) => {\r\n      let obj = { vacationID: +v.vacationID, followers: 1 };\r\n      const vacation = stateVacations.find((f) => f.vacationID === v.vacationID);\r\n      if (vacation) {\r\n        vacation.followers += 1;\r\n        return;\r\n      }\r\n      stateVacations.push(obj);\r\n    });\r\n    stateVacations.sort((a, b) => { return a.vacationID - b.vacationID });\r\n    this.setState({ vacations: stateVacations });\r\n  }\r\n\r\n  private arrangeTicksValueForChart = () => {\r\n    const vacations = [...this.state.vacations];\r\n    const tickValueArr = [...this.state.tickValueArr];\r\n    vacations.map(v => tickValueArr.push(v.vacationID));\r\n    this.setState({ tickValueArr });\r\n  }\r\n  private arrangeTicksFormatForChart = () => {\r\n    const vacations = [...this.state.vacations];\r\n    const tickFormatArr = [...this.state.tickFormatArr]\r\n    vacations.map(v => tickFormatArr.push(`ID : ${v.vacationID}`));\r\n    this.setState({ tickFormatArr });\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    return (\r\n      <div className='chart'>\r\n        {this.state.user.isAdmin ?\r\n        <React.Fragment>\r\n          <h1>Reports Page</h1>\r\n          <VictoryChart\r\n            theme={VictoryTheme.material}\r\n            width={600}\r\n            domainPadding={60}\r\n          >\r\n            <VictoryAxis\r\n              tickValues={this.state.tickValueArr}\r\n              tickFormat={this.state.tickFormatArr}\r\n            />\r\n            <VictoryAxis\r\n              dependentAxis\r\n              tickFormat={(x) => (`${x}`)}\r\n            />\r\n            <VictoryBar\r\n              data={this.state.vacations}\r\n              x=\"vacationID\"\r\n              y=\"followers\"\r\n            />\r\n          </VictoryChart>\r\n          </React.Fragment>\r\n        : <PageNotFound />}\r\n      </div>\r\n    );\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}